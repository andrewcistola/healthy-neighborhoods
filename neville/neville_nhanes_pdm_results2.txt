#### Healthy Neighborhoods Project: Using Ecological Data to Improve Community Health
### Neville Subproject: Using Random Forestes, Factor Analysis, and Logistic regression to Screen Variables for Imapcts on Public Health
## National Health and Nutrition Examination Survey: The R Project for Statistical Computing Script by DrewC!
# Detecting Prediabetes in those under 65

Factor Analysis
 
Eigenvalues from Scree Test
 
Call: fa.parallel(x = cor_fa)
Parallel analysis suggests that the number of factors =  8  and the number of components =  8 

 Eigen Values of 

 eigen values of factors
  [1] 25.02 11.44  8.53  6.95  5.69  5.48  5.24  4.96  4.28  3.99  3.46  3.31
 [13]  3.20  3.08  2.88  2.82  2.63  2.50  2.42  2.38  2.27  2.11  2.09  1.96
 [25]  1.89  1.84  1.80  1.67  1.53  1.52  1.40  1.34  1.28  1.28  1.23  1.18
 [37]  1.11  1.05  0.99  0.99  0.89  0.86  0.84  0.79  0.74  0.70  0.69  0.65
 [49]  0.62  0.55  0.53  0.50  0.46  0.45  0.41  0.37  0.35  0.33  0.31  0.28
 [61]  0.27  0.24  0.21  0.18  0.15  0.14  0.10  0.09  0.06  0.02  0.01  0.00
 [73]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 [85]  0.00  0.00  0.00  0.00  0.00 -0.01 -0.02 -0.05 -0.06 -0.07 -0.10 -0.12
 [97] -0.13 -0.16 -0.16 -0.18 -0.19 -0.20 -0.21 -0.22 -0.23 -0.24 -0.26 -0.27
[109] -0.29 -0.29 -0.30 -0.31 -0.32 -0.33 -0.34 -0.34 -0.36 -0.36 -0.38 -0.38
[121] -0.39 -0.40 -0.40 -0.42 -0.43 -0.44 -0.44 -0.45 -0.46 -0.47 -0.48 -0.49
[133] -0.50 -0.51 -0.52 -0.53 -0.55 -0.57 -0.57 -0.59 -0.59 -0.60 -0.61 -0.61
[145] -0.62 -0.64 -0.64 -0.66 -0.67 -0.67 -0.68 -0.69 -0.70 -0.71 -0.71 -0.72
[157] -0.73 -0.74 -0.74 -0.75 -0.76 -0.77 -0.77 -0.78 -0.79 -0.79 -0.80 -0.80
[169] -0.81 -0.81 -0.82 -0.82 -0.83 -0.83 -0.84 -0.84 -0.84 -0.85 -0.85 -0.85
[181] -0.86 -0.86 -0.87 -0.87 -0.87 -0.88 -0.88 -0.89 -0.89 -0.90 -0.90 -0.90
[193] -0.91 -0.91 -0.91 -0.91 -0.92 -0.92 -0.93 -0.93 -0.93 -0.94 -0.94 -0.94
[205] -0.94 -0.95 -0.95 -0.95 -0.95 -0.95 -0.95 -0.96 -0.96 -0.96 -0.96 -0.96
[217] -0.96 -0.96 -0.96 -0.96 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97
[229] -0.97 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98
[241] -0.98 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99
[253] -0.99 -0.99 -0.99 -0.99 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00
[265] -1.00 -1.00

 eigen values of simulated factors
  [1]  5.82  5.49  5.23  5.09  4.89  4.76  4.62  4.50  4.37  4.22  4.10  4.01
 [13]  3.90  3.82  3.70  3.63  3.55  3.47  3.37  3.27  3.19  3.11  3.04  2.96
 [25]  2.90  2.81  2.73  2.64  2.58  2.52  2.45  2.39  2.33  2.28  2.21  2.15
 [37]  2.09  2.03  1.96  1.91  1.85  1.79  1.73  1.69  1.63  1.58  1.53  1.48
 [49]  1.43  1.36  1.32  1.28  1.23  1.18  1.14  1.09  1.05  1.00  0.96  0.91
 [61]  0.86  0.82  0.78  0.74  0.70  0.66  0.62  0.58  0.54  0.50  0.47  0.43
 [73]  0.39  0.36  0.32  0.28  0.23  0.20  0.17  0.13  0.09  0.06  0.03 -0.01
 [85] -0.04 -0.07 -0.10 -0.13 -0.17 -0.20 -0.23 -0.27 -0.30 -0.34 -0.37 -0.40
 [97] -0.45 -0.48 -0.53 -0.87 -0.89 -0.90 -0.91 -0.91 -0.92 -0.92 -0.93 -0.93
[109] -0.93 -0.94 -0.94 -0.94 -0.94 -0.94 -0.95 -0.95 -0.95 -0.95 -0.95 -0.95
[121] -0.95 -0.95 -0.96 -0.96 -0.96 -0.96 -0.96 -0.96 -0.96 -0.96 -0.96 -0.96
[133] -0.96 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97
[145] -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.97 -0.98 -0.98 -0.98 -0.98 -0.98
[157] -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98
[169] -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.98 -0.99 -0.99
[181] -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99
[193] -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99
[205] -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99
[217] -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -0.99 -1.00 -1.00 -1.00
[229] -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00
[241] -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00
[253] -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00
[265] -1.00 -1.00

 eigen values of components 
  [1] 25.55 12.40  9.45  7.88  6.66  6.41  6.19  5.89  5.20  4.93  4.40  4.25
 [13]  4.15  4.04  3.85  3.76  3.58  3.44  3.36  3.33  3.21  3.05  3.04  2.88
 [25]  2.84  2.78  2.75  2.61  2.45  2.44  2.34  2.29  2.23  2.19  2.16  2.08
 [37]  2.03  2.00  1.94  1.92  1.85  1.80  1.78  1.74  1.65  1.62  1.61  1.57
 [49]  1.55  1.47  1.44  1.41  1.37  1.35  1.34  1.30  1.26  1.25  1.23  1.22
 [61]  1.19  1.14  1.12  1.07  1.05  1.04  1.00  1.00  1.00  1.00  1.00  1.00
 [73]  1.00  1.00  1.00  1.00  1.00  1.00  1.00  1.00  1.00  1.00  1.00  1.00
 [85]  1.00  0.99  0.98  0.93  0.92  0.89  0.87  0.85  0.82  0.81  0.78  0.76
 [97]  0.75  0.73  0.73  0.70  0.69  0.65  0.63  0.62  0.60  0.59  0.59  0.57
[109]  0.55  0.54  0.53  0.52  0.51  0.49  0.47  0.47  0.44  0.43  0.41  0.39
[121]  0.37  0.36  0.35  0.34  0.34  0.34  0.32  0.30  0.29  0.28  0.27  0.26
[133]  0.25  0.25  0.24  0.24  0.23  0.22  0.21  0.21  0.20  0.20  0.19  0.18
[145]  0.18  0.16  0.16  0.16  0.15  0.14  0.13  0.13  0.12  0.12  0.11  0.10
[157]  0.09  0.09  0.09  0.09  0.08  0.08  0.07  0.07  0.06  0.06  0.05  0.05
[169]  0.05  0.04  0.04  0.04  0.03  0.03  0.03  0.03  0.02  0.02  0.02  0.02
[181]  0.02  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[193]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[205]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[217]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[229]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[241]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[253]  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00
[265]  0.00  0.00

 eigen values of simulated components
  [1] 6.76 6.46 6.21 6.07 5.87 5.73 5.60 5.48 5.35 5.20 5.08 4.99 4.88 4.80 4.68
 [16] 4.61 4.53 4.45 4.35 4.25 4.17 4.09 4.02 3.94 3.88 3.79 3.71 3.62 3.56 3.50
 [31] 3.43 3.36 3.30 3.26 3.19 3.13 3.07 3.00 2.94 2.88 2.82 2.77 2.71 2.66 2.61
 [46] 2.56 2.51 2.46 2.40 2.34 2.30 2.26 2.21 2.16 2.12 2.07 2.02 1.98 1.93 1.89
 [61] 1.84 1.80 1.76 1.72 1.68 1.64 1.60 1.56 1.52 1.48 1.45 1.41 1.37 1.33 1.29
 [76] 1.25 1.21 1.18 1.15 1.11 1.07 1.04 1.01 0.97 0.94 0.91 0.88 0.85 0.81 0.78
 [91] 0.75 0.71 0.68 0.64 0.60 0.57 0.53 0.50 0.45 0.00 0.00 0.00 0.00 0.00 0.00
[106] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[121] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[136] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[151] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[166] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[181] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[196] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[211] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[226] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[241] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
[256] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
 
Factor Loadings
 
        factor1
OHX02TC       1
OHX03TC       1
OHX04TC       1
OHX05TC       1
OHX06TC       1
OHX07TC       1
OHX08TC       1
OHX09TC       1
OHX10TC       1
OHX11TC       1
OHX12TC       1
OHX13TC       1
OHX14TC       1
OHX15TC       1
OHX18TC       1
OHX19TC       1
OHX20TC       1
OHX21TC       1
OHX22TC       1
OHX23TC       1
OHX24TC       1
OHX25TC       1
OHX26TC       1
OHX27TC       1
OHX28TC       1
OHX29TC       1
OHX30TC       1
OHX31TC       1
         factor2
BMXWT          1
BMXBMI         1
BMXARMC        1
BMXWAIST       1
BMXSAD1        1
BMXSAD2        1
BMDAVSAD       1
BPACSZ         1
         factor3
DMDHHSIZ       1
         factor4
INDHHIN2       1
INDFMIN2       1
INDFMPIR       1
IND235         1
INDFMMPI       1
INDFMMPC       1
        factor5
BMXHT         1
BMXLEG        1
BMXARML       1
LBXTST        1
         factor6
LBXWBCSI       1
LBDMONO        1
LBDNENO        1
         factor7
LBDRFO         1
LBDRFOSI       1
LBDFOTSI       1
LBDFOT         1
LBXSF1SI       1
LBXSF2SI       1
LBXSF4SI       1
LBXSF5SI       1
       factor8
BPXML1       1
BPXSY1       1
BPXDI1       1
BPXSY2       1
BPXDI2       1
BPXSY3       1
BPXDI3       1
         factor9
DMDHREDU       1
       factor10
HEQ030        1
MCQ203        1
 
Random Forest Variable Classification
 
Variable   MSE   Gini
1   RIDAGEYR   23.49   7.26
2   DMDHRAGE   10.79   3.71
3   LBXRDW   8.01   2.75
4   URDACT   7.07   2.66
5   BMDAVSAD   8.74   2.2
6   BMXSAD2   9.92   2.06
7   LBXHGB   6.9   2
8   LBXWBCSI   2.07   1.9
9   LBXTC   6.14   1.9
10   LBDTCSI   5.94   1.87
11   LBXSF2SI   3.74   1.74
12   BMXSAD1   7.18   1.66
13   WTMEC2YR   3.95   1.64
14   LBXMCHSI   3.53   1.61
15   LBXMOPCT   4.77   1.6
16   LBXSF6SI   3.82   1.6
17   BMXWAIST   6.36   1.48
18   BMXLEG   3.46   1.46
19   WTINT2YR   3.79   1.46
21   LBXEST   2.88   1.33
22   BMXHT   2.53   1.32
23   LBXLYPCT   1.91   1.3
24   LBDLYMNO   1.73   1.26
25   CBD121   0.6   1.26
26   INDFMPIR   2.03   1.22
27   LBDNENO   0.36   1.18
28   LBXNEPCT   0.93   1.17
30   LBXTST   1.07   1.12
32   LBXHSCRP   2.63   1.08
33   BMXBMI   4.32   1.07
35   DMDHHSZE   6.91   1.05
36   LBDHDDSI   2.72   1.03
37   BPXDI3   4.7   1.02
38   BMXWT   3.24   0.99
39   BPXDI1   4.22   0.99
42   LBDHDD   2.73   0.99
43   URXUMA   1.3   0.98
44   URDTIME1   0.05   0.98
45   LBXSF1SI   4.19   0.96
47   BMXARML   0.42   0.91
49   BMXARMC   3.99   0.89
50   LBDRFO   1.25   0.88
51   INDFMMPI   1.13   0.88
52   INQ030   10.11   0.87
53   URXUCR   0.9   0.85
54   INDFMIN2   2.24   0.84
55   LBDRFOSI   0.09   0.83
58   LBXSF4SI   2.29   0.82
60   CBD091   1.92   0.8
62   BPXDI2   3.23   0.77
63   BPXSY3   4.43   0.77
64   LBDFOT   1.98   0.76
65   BPXSY2   0.28   0.73
66   LBDFOTSI   2.52   0.71
67   BPXSY1   3.7   0.68
68   PAD680   0.39   0.67
72   INDHHIN2   2.98   0.58
74   OHX19TC   4.08   0.54
76   HOD050   2.34   0.5
81   PAQ710   0.07   0.47
82   DMDHHSIZ   0.64   0.45
84   DBD900   0.85   0.42
86   OHX15TC   4.46   0.39
89   HUQ010   1.74   0.38
90   DMDFMSIZ   0.85   0.37
91   RIDRETH3   1.1   0.34
92   DIQ050   7.23   0.34
95   BPXML1   1.36   0.32
96   LBDEONO   0.76   0.32
97   DMDHREDU   1.14   0.31
98   IMQ020   1.55   0.31
99   OHX09TC   4.95   0.3
102   INQ320   3.33   0.28
103   DBQ197   0.37   0.26
104   HUQ030   4.01   0.25
105   IMQ011   2.83   0.25
108   DMDHRMAR   1.69   0.24
109   OHX14TC   3.14   0.24
110   OHX30TC   3.12   0.24
111   AUQ054   0.97   0.23
112   DMDHHSZA   1.87   0.22
113   MCQ300B   0.81   0.22
114   LBXSF5SI   1.02   0.21
119   LBXHBC   1.43   0.19
121   HSQ510   0.51   0.18
122   OHX13TC   2.98   0.18
123   PAQ635   3.18   0.18
125   OHX16TC   0.89   0.17
126   BPQ080   1.34   0.16
127   OHX02TC   1.05   0.16
128   HSQ500   1.29   0.15
129   OHX03TC   2.1   0.15
131   OHX06TC   3.72   0.14
132   HUQ041   0.16   0.13
134   OCD390G   0.52   0.13
135   OHX08TC   2.59   0.13
136   INQ020   1.89   0.12
138   OHX25TC   2.14   0.12
139   SMQ874   1.7   0.12
140   BPQ020   1.46   0.11
141   MIALANG   0.05   0.11
146   INQ080   3.23   0.1
147   OHX24TC   2.83   0.1
151   INQ090   0.15   0.09
152   PUQ110   0.44   0.09
153   CBQ550   0.12   0.08
155   MIAINTRP   1.19   0.08
159   MCQ053   0.92   0.08
160   MCQ080   2.49   0.08
161   MCQ370A   0.36   0.08
162   MCQ370C   1.19   0.08
163   OCD150   0.32   0.08
164   OHX32TC   0.28   0.08
165   SLQ050   0.84   0.08
167   LBDBANO   0.17   0.07
168   DMDHRBR4   0.68   0.07
169   HSQ520   1.38   0.07
170   INQ132   0.7   0.07
172   MCQ092   0.88   0.07
175   OHX18TC   1.44   0.07
178   SIALANG   0.55   0.06
179   DMDHRGND   1.84   0.06
180   DLQ020   1.31   0.06
181   LBDHEG   1.43   0.06
182   HUQ071   1.08   0.06
185   MCQ365D   0.22   0.06
192   BPAEN3   2.86   0.05
193   DMDBORN4   0.01   0.05
196   DLQ080   0.71   0.05
199   LBDSF5LC   2.41   0.05
200   LBDHEM   0.78   0.05
202   HUQ090   0.21   0.05
204   OHX04TC   0.93   0.05
205   OHX12TC   0.2   0.05
207   OHX23TC   1.94   0.05
208   OHX27TC   2.19   0.05
209   SMQ878   0.23   0.05
211   BPAEN2   1.12   0.04
213   RIAGENDR   1.69   0.04
217   MCQ010   0.31   0.04
218   OHX07TC   1.18   0.04
220   OHX20TC   1.87   0.04
221   OHX26TC   2.92   0.04
222   OHX28TC   0.26   0.04
223   OHAPOS   1.3   0.04
226   BPXPULS   1.6   0.03
227   LBDHCTLC   1.83   0.03
230   OHX10TC   0.84   0.03
231   OHX22TC   1.19   0.03
232   OHX29TC   0.83   0.03
233   LBDESTLC   1.42   0.03
238   LBDHRPLC   1.17   0.02
240   SMAQUEX2   1.34   0.02
241   FIAINTRP   0.32   0.01
242   LBDSF2LC   2   0.01
 
Summary of Model Variables
 
OHX19TC
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.000   2.000   2.000   2.573   4.000   4.000 

BMDAVSAD
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  13.20   19.30   22.10   22.56   25.60   38.60 
 
DMDHHSIZ
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   3.000   3.242   4.000   7.000 
 
INDFMIN2
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   5.000   7.000   8.156  10.000  15.000 
 
BMXLEG
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  27.20   36.20   38.85   38.72   41.20   50.50 

LBXWBCSI
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.200   5.900   7.100   7.422   8.600  17.200 
 
LBXSF2SI
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0990  0.4600  0.6100  2.1201  0.9225 92.6000 
 
BPXDI3
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   61.50   68.00   67.99   76.00  106.00 
 
DMDHREDU
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    3.00    4.00    3.55    4.00    9.00 
 
 
First Logistic Regression for Variable Direction
 
Call:
glm(formula = outcome ~ OHX19TC + BMDAVSAD + DMDHHSIZ + INDFMIN2 +
    BMXLEG + LBXWBCSI + LBXSF2SI + BPXDI3 + DMDHREDU, data = df_nev)

Deviance Residuals:
    Min       1Q   Median       3Q      Max
-0.7356  -0.2610  -0.1425   0.3922   1.0264

Coefficients:
              Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.0760171  0.2277184  -0.334 0.738626
OHX19TC      0.0787080  0.0202105   3.894 0.000109 ***
BMDAVSAD     0.0182067  0.0039400   4.621 4.63e-06 ***
DMDHHSIZ    -0.0161022  0.0107351  -1.500 0.134128    
INDFMIN2    -0.0052944  0.0044622  -1.187 0.235871    
BMXLEG      -0.0051288  0.0044749  -1.146 0.252176
LBXWBCSI     0.0052831  0.0079209   0.667 0.505030
LBXSF2SI     0.0048707  0.0020273   2.403 0.016567 *  
BPXDI3       0.0004175  0.0012754   0.327 0.743518
DMDHREDU    -0.0182911  0.0142127  -1.287 0.198582    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1691762)

    Null deviance: 121.98  on 639  degrees of freedom
Residual deviance: 106.58  on 630  degrees of freedom
AIC: 691

Number of Fisher Scoring iterations: 2

Model Calculation

RIDAGEYR < 65
df_nh$OHX[df_nh$OHX01TC == 4 | df_nh$OHX02TC == 4 | df_nh$OHX03TC == 4 | df_nh$OHX04TC == 4 | df_nh$OHX05TC == 4 | df_nh$OHX06TC == 4 | df_nh$OHX07TC == 4 | df_nh$OHX08TC == 4 | df_nh$OHX09TC == 4 | df_nh$OHX10TC == 4 | df_nh$OHX11TC == 4 | df_nh$OHX12TC == 4 | df_nh$OHX13TC == 4 | df_nh$OHX14TC == 4 | df_nh$OHX15TC == 4 | df_nh$OHX16TC == 4 | df_nh$OHX17TC == 4 | df_nh$OHX18TC == 4 | df_nh$OHX19TC == 4 | df_nh$OHX20TC == 4 | df_nh$OHX21TC == 4 | df_nh$OHX22TC == 4 | df_nh$OHX23TC == 4 | df_nh$OHX24TC == 4 | df_nh$OHX25TC == 4 | df_nh$OHX26TC == 4 | df_nh$OHX27TC == 4 | df_nh$OHX28TC == 4 | df_nh$OHX29TC == 4 | df_nh$OHX30TC == 4 | df_nh$OHX31TC == 4 | df_nh$OHX32TC == 4] <- 1 # Create new column based on conditions
df_nh$SAG[df_nh$BMDAVSAD > 25.6] <- 1 # Create new column based on conditions
df_nh$NHS[df_nh$DMDHHSIZ <= 2] <- 1 # Create new column based on conditions
df_nh$INC[df_nh$INDFMIN2 <= 5] <- 1 # Create new column based on conditions
df_nh$LEG[df_nh$BMXLEG < 36.2] <- 1 # Create new column based on conditions
df_nh$DBP[df_nh$BPXDI3 < 76] <- 1 # Create new column based on conditions
df_nh$EDU[df_nh$DMDHREDU <= 4] <- 1 # Create new column based on conditions
 
Training Logistic Regression Model
 

Call:
lm(formula = outcome ~ OHX02TC + BMDAVSAD + DMDHHSIZ + INDFMIN2 + 
    BMXLEG + LBXWBCSI + LBXSF2SI + BPXDI3 + DMDHREDU, data = df_nev)

Coefficients:
(Intercept)      OHX02TC     BMDAVSAD     DMDHHSIZ     INDFMIN2       BMXLEG  
   0.013401     0.060009     0.019558    -0.018897    -0.005361    -0.006015  
   LBXWBCSI     LBXSF2SI       BPXDI3     DMDHREDU  
   0.004408     0.004927     0.000341    -0.020868  

 
Call:
glm(formula = outcome ~ OHX + SAG + NHS + INC + LEG + DBP, data = train)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.54443  -0.11511  -0.06338  -0.06338   0.96489  

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.03511    0.01253   2.803  0.00509 ** 
OHX          0.02827    0.01320   2.141  0.03235 *  
SAG          0.21878    0.01575  13.887  < 2e-16 ***
NHS          0.08973    0.01293   6.939 4.54e-12 ***
INC          0.02062    0.01151   1.792  0.07328 .  
LEG          0.03112    0.01231   2.529  0.01148 *  
DBP          0.12082    0.01427   8.465  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1010453)

    Null deviance: 479.59  on 4295  degrees of freedom
Residual deviance: 433.38  on 4289  degrees of freedom
AIC: 2353.3

Number of Fisher Scoring iterations: 2

test$score = (3*test$OHX) + (21*test$SAG) + (9*test$NHS) + (3*test$LEG) + (12*test$DBP)
 
Risk Score Validation
 
Area under the curve: 0.7202
 
